<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Greek Bible</title>
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="Styles/css/Loading.css">
</head>
<body class="loadingScreen">

    <div id="loadingScreen" class="loadingScreen">
        <div style="height: 50px"></div>
        <img src="Assets/images/mainLoader.gif" />
        <div>Loading...</div>
        <div id="loadingProgress"></div>
    </div>

    <div data-role="page" id="home" style="display: none">
        <div data-role="header">
            <h1>Greek Bible</h1>
        </div>
        <div data-role="content">
            <h3>Select Passage:</h3>
            <!--<select>
                <option>1</option>
                <option>2</option>
                <option>3</option>
            </select>-->

            <select data-bind="options: choosePassage.bookChoices(), value:choosePassage.book, refreshJQM:choosePassage.book"></select>
            <select id="selChapter" data-bind="options: choosePassage.chapterChoices(), value:choosePassage.chapter, refreshJQM:choosePassage.chapter, refreshJQM:choosePassage.book, hasFocus: choosePassage.isChapterFocused"></select>
            <!--<h4><span data-bind="text: passage().entries.length"></span>&nbsp;Words</h4>-->
            <!-- ko if: displayPassage.isPassageLoading -->
            <div>

                <div>
                    <img src="Assets/images/mainLoader.gif" />
                    <p>Loading Passage...</p>
                </div>
            </div>
            <!-- /ko -->
            <!-- ko if: displayPassage.hasPassageLoadingFailed -->
            <div>
                <p>
                    <img src="Assets/images/icons-png/alert-black.png" />
                    Passage Failed to Load.
                </p>
                <p>
                    Please, check your internet connection.<br />
                    Change the chapter to try again.
                </p>
            </div>
            <!-- /ko -->
            <!-- ko if: displayPassage.isPassageLoaded -->
            <h3><span data-bind="text: displayPassage.book() + ' ' + displayPassage.chapter()"></span></h3>

            <div data-bind="dustTemplate: displayPassage.passage">
                {#entries}
                {?isVerseStart}
                <div class="verse">{passageRef.verse}</div>
                {/isVerseStart}
                <div class="entry">
                    <div class="rawText">{rawText}</div>
                    <div class="partOfSpeechColor" style="background-color:{partOfSpeech.color}"></div>
                    <div class="morphColor" style="background-color:{morph.color}"></div>
                    <div class="lemma">{lemma}</div>
                    <div class="partOfSpeechCode" style="color:{partOfSpeech.color}">{partOfSpeech.partOfSpeechCode}</div>
                    <div class="morphCode" style="color:{morph.color}">{morph.morphCode}</div>
                </div>
                &nbsp;
                {/entries}
            </div>
            <!-- /ko -->
        </div>
        <div data-role="footer">
            <h4>&copy; Told - Rick Love - 2014</h4>
        </div>
    </div>

    <div id="test" style="display: none">
        <div data-role="header">
            <h1>Greek Bible - Testing</h1>
        </div>
        <div data-role="content">
            <div id="qunit">Please refresh to load the testing system.</div>
        </div>
        <div data-role="footer">
            <h4>&copy; Told - Rick Love - 2014</h4>
        </div>
    </div>

    <script src="Scripts/ts/System/AppLoader.js"></script>

    <script type='text/javascript'>
        var onProgress = function (p) {
            var divProgress = document.getElementById("loadingProgress");
            divProgress.textContent = (p * 100).toFixed(0) + "%";
        }

        Told.AppLoader.loadRequirements_Main(function () {

            var viewModel = new Told.GreekBible.UI.MainViewModel();
            ko.applyBindings(viewModel);

            var hash = location.hash;
            if ($(hash).length === 0) { hash = "#home"; }
            $(hash).show();

            $("#loadingScreen").hide();
            $(".loadingScreen").removeClass("loadingScreen");
        }, onProgress);
    </script>


    <script type='text/javascript'>
        if (location.href.indexOf("test") > 0) {
            Told.AppLoader.loadRequirements_Testing(function () {

                QUnit.config.autostart = false;

                Told.GreekBible.Tests.runTests(function () {
                    $(document).ready(function () {
                        QUnit.load();
                        QUnit.start();
                    });
                });
            });
        }
    </script>

</body>
</html>
